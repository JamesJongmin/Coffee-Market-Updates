<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Coffee Market In-depth Analysis - ì»¤í”¼ ì‹œì¥ ì‹¬ì¸µ ë¶„ì„ ë³´ê³ ì„œ">
    <title>In-depth Analysis - Coffee Market Updates</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="styles/common.css" as="style">
    <link rel="stylesheet" href="styles/common.css">
    
    <style>
        /* Page-specific styles */
        .analysis-hero {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: white;
            padding: 48px 24px;
            border-radius: var(--radius-xl);
            margin-bottom: 40px;
            text-align: center;
            box-shadow: var(--shadow-xl);
            position: relative;
            overflow: hidden;
        }

        .analysis-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 30s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .analysis-title {
            font-size: clamp(1.75rem, 5vw, 2.75rem);
            font-weight: 700;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
        }

        .analysis-subtitle {
            font-size: 1.25rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        /* Info Section Enhanced */
        .info-card {
            background: white;
            padding: 32px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            margin-bottom: 40px;
            border-top: 4px solid var(--primary-color);
            position: relative;
            overflow: hidden;
        }

        .info-card::after {
            content: 'ğŸ”';
            position: absolute;
            right: -20px;
            bottom: -20px;
            font-size: 120px;
            opacity: 0.05;
            transform: rotate(-15deg);
        }

        .info-header {
            font-size: 1.75rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .info-text {
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-top: 24px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(139, 69, 19, 0.05);
            border-radius: var(--radius-md);
            transition: all var(--transition-fast);
        }

        .feature-item:hover {
            background: rgba(139, 69, 19, 0.1);
            transform: translateX(4px);
        }

        .feature-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
            color: var(--primary-color);
        }

        /* Analysis Reports Grid */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        /* Enhanced Report Card */
        .analysis-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 28px;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            border-top: 3px solid transparent;
            border-image: linear-gradient(90deg, var(--primary-color), var(--primary-light));
            border-image-slice: 1;
        }

        .analysis-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(139, 69, 19, 0.05), transparent);
            transition: left 0.5s ease;
        }

        .analysis-card:hover::before {
            left: 100%;
        }

        .analysis-card:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: var(--shadow-xl);
        }

        .analysis-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .analysis-date {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 0.875rem;
        }

        .analysis-heading {
            font-size: 1.375rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .analysis-summary {
            color: var(--text-secondary);
            font-size: 0.9375rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .analysis-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .analysis-link {
            color: var(--primary-color);
            font-weight: 600;
            text-decoration: none;
            font-size: 0.9375rem;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            transition: all var(--transition-fast);
        }

        .analysis-link:hover {
            gap: 8px;
            color: var(--primary-dark);
        }

        /* Loading & Empty States */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .empty-state h3 {
            color: var(--text-secondary);
            font-size: 1.5rem;
            margin-bottom: 12px;
        }

        /* Back Button Enhanced */
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: white;
            padding: 12px 24px;
            border-radius: var(--radius-round);
            text-decoration: none;
            font-weight: 600;
            transition: all var(--transition-normal);
            margin-bottom: 32px;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
        }

        .back-link::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .back-link:hover::before {
            width: 300px;
            height: 300px;
        }

        .back-link:hover {
            transform: translateX(-4px);
            box-shadow: var(--shadow-lg);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .analysis-hero {
                padding: 32px 20px;
            }
            
            .info-card {
                padding: 24px;
            }
            
            .feature-list {
                grid-template-columns: 1fr;
            }
            
            .analysis-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">
            â† ë©”ì¸ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°
        </a>
        
        <div class="analysis-hero fade-in">
            <h1 class="analysis-title">ğŸ” In-depth Analysis</h1>
            <p class="analysis-subtitle">ì»¤í”¼ ì‹œì¥ ì‹¬ì¸µ ë¶„ì„ ë³´ê³ ì„œ</p>
        </div>
        
        <div class="info-card fade-in" style="animation-delay: 0.1s;">
            <h2 class="info-header">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z"/>
                </svg>
                In-depth ë¶„ì„ ë¦¬í¬íŠ¸
            </h2>
            <p class="info-text">
                ì»¤í”¼ ì‹œì¥ì˜ íŠ¹ë³„ ì´ìŠˆì™€ ì‹¬ì¸µ ë¶„ì„ì„ ë‹¤ë£¨ëŠ” ë³´ê³ ì„œë“¤ì…ë‹ˆë‹¤. 
                ì£¼ê°„ ë™í–¥ ì™¸ì— íŠ¹ì • ì£¼ì œì— ëŒ€í•œ ê¹Šì´ ìˆëŠ” ë¶„ì„ì„ ì œê³µí•©ë‹ˆë‹¤.
            </p>
            
            <div class="feature-list">
                <div class="feature-item">
                    <svg class="feature-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                    </svg>
                    <span>ë‹¨ê¸° ê°€ê²© ì „ë§ê³¼ ë°©í–¥ì„± ë¶„ì„</span>
                </div>
                <div class="feature-item">
                    <svg class="feature-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"/>
                    </svg>
                    <span>ê¸°ìˆ ì  ë¶„ì„ê³¼ ì°¨íŠ¸ íŒ¨í„´</span>
                </div>
                <div class="feature-item">
                    <svg class="feature-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                    <span>íŠ¹ë³„ ì´ë²¤íŠ¸ ë° ì‹œì¥ ì¶©ê²© ë¶„ì„</span>
                </div>
                <div class="feature-item">
                    <svg class="feature-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/>
                    </svg>
                    <span>ì¥ê¸° íŠ¸ë Œë“œì™€ êµ¬ì¡°ì  ë³€í™”</span>
                </div>
                <div class="feature-item">
                    <svg class="feature-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                    </svg>
                    <span>ì¸í¬ê·¸ë˜í”½ ë° ì‹œê°í™” ìë£Œ</span>
                </div>
            </div>
        </div>
        
        <div id="loadingState" class="loading-spinner fade-in" style="animation-delay: 0.2s;">
            <div class="spinner"></div>
            <p style="margin-top: 16px;">ë¦¬í¬íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
        
        <div class="analysis-grid" id="analysisGrid" style="display: none;">
            <!-- Analysis reports will be dynamically loaded here -->
        </div>
        
        <div class="empty-state" id="emptyState" style="display: none;">
            <div class="empty-state-icon">ğŸ“Š</div>
            <h3>ì‹¬ì¸µ ë¶„ì„ ë¦¬í¬íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤</h3>
            <p>ì•„ì§ ì‹¬ì¸µ ë¶„ì„ ë¦¬í¬íŠ¸ê°€ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
        </div>
    </div>

    <script>
        // Optimized in-depth analysis report manager
        class AnalysisReportManager {
            constructor() {
                this.reports = [];
                this.loading = true;
                this.specialReports = {
                    'Reports/2025/08/2025-08-17.html': {
                        title: 'í¼í™íŠ¸ ìŠ¤í†°: 2025ë…„ ì»¤í”¼ ê°€ê²© ê¸‰ë“± ë”¥ë‹¤ì´ë¸Œ',
                        summary: '2025ë…„ ì»¤í”¼ ì‹œì¥ì˜ ì™„ë²½í•œ í­í’ì„ ë¶„ì„í•©ë‹ˆë‹¤. ê¸°í›„ ë³€í™”, ê³µê¸‰ë§ ìœ„ê¸°, ìˆ˜ìš” ê¸‰ì¦ì´ ë™ì‹œì— ë°œìƒí•˜ë©° ì—­ì‚¬ì ì¸ ê°€ê²© ê¸‰ë“±ì„ ì´ˆë˜í•œ ìš”ì¸ë“¤ì„ ì‹¬ì¸µ ë¶„ì„í•©ë‹ˆë‹¤.',
                        tags: ['ì‹¬ì¸µë¶„ì„', 'ê°€ê²©ê¸‰ë“±', 'í¼í™íŠ¸ìŠ¤í†°', 'ê¸°í›„ë³€í™”', 'ê³µê¸‰ë§ìœ„ê¸°']
                    },
                    'Reports/2025/06/2025-06-14.html': {
                        title: 'ë‹¨ê¸° ì»¤í”¼ ì„ ë¬¼ ê°€ê²© ì „ë§ ë° ë°©í–¥ì„± ì ê²€',
                        summary: 'KCN25ëŠ” 349.90ì„¼íŠ¸ë¡œ +0.60% ìƒìŠ¹í•˜ë©° 1ì°¨ ì§€ì§€ì„ ì„ ìƒíšŒ íšŒë³µí–ˆìŠµë‹ˆë‹¤. ë‹¨ê¸°ì ìœ¼ë¡œëŠ” ë¸Œë¼ì§ˆ ìˆ˜í™• ì§„í–‰ê³¼ íˆ¬ê¸°ì  ìˆ í¬ì§€ì…˜ì´ í•˜ë°© ì••ë ¥ìœ¼ë¡œ ì‘ìš©í•©ë‹ˆë‹¤.',
                        tags: ['ë‹¨ê¸°ì „ë§', 'ê¸°ìˆ ì ë¶„ì„', 'ë¸Œë¼ì§ˆìˆ˜í™•', 'ì•„ë¼ë¹„ì¹´ì ì', 'íˆ¬ê¸°í¬ì§€ì…˜']
                    },
                    'Reports/2025/06/2025-06-24.html': {
                        title: 'ì»¤í”¼ ê°€ê²©, í­í’ ì „ì•¼ - ì•„ë¼ë¹„ì¹´ ì‹œì¥ ì¸í¬ê·¸ë˜í”½',
                        summary: 'ì•„ë¼ë¹„ì¹´ ì»¤í”¼ ì‹œì¥ì€ ê°•ë ¥í•œ ê°•ì„¸ ìš”ì¸ê³¼ ì ì¬ì  ì•½ì„¸ ë¦¬ìŠ¤í¬ê°€ ì¶©ëŒí•˜ë©° ë†’ì€ ë³€ë™ì„±ì„ ì˜ˆê³ í•˜ê³  ìˆìŠµë‹ˆë‹¤.',
                        tags: ['ì¸í¬ê·¸ë˜í”½', 'ê°€ê²©ì „ë§', 'ë¸Œë¼ì§ˆì„œë¦¬', 'ê³µê¸‰ë¶€ì¡±', 'ë³€ë™ì„±']
                    }
                };
            }

            async init() {
                await this.loadReports();
                this.render();
            }

            async loadReports() {
                try {
                    // Try loading from reports.json
                    const response = await fetch('reports.json');
                    if (response.ok) {
                        const data = await response.json();
                        this.reports = (data.reports || []).filter(report => 
                            this.isAnalysisReport(report)
                        );
                    }
                } catch (error) {
                    console.error('Failed to load reports:', error);
                    // Fallback to file scanning
                    this.reports = await this.scanAnalysisReports();
                }

                // Sort by date (newest first)
                this.reports.sort((a, b) => new Date(b.date) - new Date(a.date));
                this.loading = false;
            }

            isAnalysisReport(report) {
                // Check if it's specifically marked as in-depth
                if (report.type === 'in-depth' || report.type === 'in-depth-analysis') return true;
                
                // Exclude weekly reports
                const title = report.title || '';
                const isWeekly = title.includes('ì£¼ê°„ ë™í–¥') || 
                                title.includes('ì»¤í”¼ ì‹œì¥ ì£¼ê°„ ë™í–¥') || 
                                title.includes('ì»¤í”¼ ì„ ë¬¼ ì‹œì¥ ì£¼ê°„ ë™í–¥');
                
                return !isWeekly;
            }

            async scanAnalysisReports() {
                // Simplified scanning for in-depth analysis reports
                const analysisReports = [];
                const knownAnalysisFiles = [
                    'Reports/2025/09/2025-09-18.html',
                    'Reports/2025/09/2025-09-16.html',
                    'Reports/2025/09/2025-09-13.html',
                    'Reports/2025/09/2025-09-07.html',
                    'Reports/2025/08/2025-08-30.html',
                    'Reports/2025/08/2025-08-25.html',
                    'Reports/2025/08/2025-08-23.html',
                    'Reports/2025/08/2025-08-17.html',
                    'Reports/2025/08/2025-08-16.html',
                    'Reports/2025/08/2025-08-11.html',
                    'Reports/2025/08/2025-08-09.html',
                    'Reports/2025/08/2025-08-04.html',
                    'Reports/2025/06/2025-06-24.html',
                    'Reports/2025/06/2025-06-14.html',
                    'Reports/2025/06/2025-06-13.html',
                    'Reports/2025/06/2025-06-08.html'
                ];

                for (const file of knownAnalysisFiles) {
                    try {
                        // Check if it's a special report
                        if (this.specialReports[file]) {
                            const dateMatch = file.match(/(\d{4}-\d{2}-\d{2})/);
                            analysisReports.push({
                                ...this.specialReports[file],
                                date: dateMatch ? dateMatch[1] : new Date().toISOString().split('T')[0],
                                link: file
                            });
                            continue;
                        }

                        const response = await fetch(file);
                        if (response.ok) {
                            const html = await response.text();
                            const metadata = this.extractMetadata(html, file);
                            if (metadata && this.isAnalysisReport(metadata)) {
                                analysisReports.push({
                                    ...metadata,
                                    link: file
                                });
                            }
                        }
                    } catch (error) {
                        // Skip failed files
                    }
                }

                return analysisReports;
            }

            extractMetadata(html, filePath) {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                const dateMatch = filePath.match(/(\d{4}-\d{2}-\d{2})/);
                const date = dateMatch ? dateMatch[1] : new Date().toISOString().split('T')[0];
                
                const title = doc.querySelector('h1')?.textContent?.trim() || 'ì»¤í”¼ ì‹œì¥ ë¶„ì„';
                const summary = doc.querySelector('.highlight p, .main-story p, p')?.textContent?.trim().substring(0, 200) || '';
                
                const tags = Array.from(doc.querySelectorAll('.tag'))
                    .map(tag => tag.textContent.trim())
                    .filter(Boolean)
                    .slice(0, 6);

                return {
                    title,
                    date,
                    summary: summary ? summary + '...' : 'ì»¤í”¼ ì‹œì¥ ë¶„ì„ ë³´ê³ ì„œì…ë‹ˆë‹¤.',
                    tags: tags.length ? tags : ['ì»¤í”¼ì‹œì¥', 'ë¶„ì„']
                };
            }

            render() {
                const loadingEl = document.getElementById('loadingState');
                const gridEl = document.getElementById('analysisGrid');
                const emptyEl = document.getElementById('emptyState');

                if (this.loading) return;

                loadingEl.style.display = 'none';

                if (this.reports.length === 0) {
                    emptyEl.style.display = 'block';
                    return;
                }

                gridEl.style.display = 'grid';
                gridEl.innerHTML = '';

                this.reports.forEach((report, index) => {
                    const card = this.createReportCard(report);
                    card.style.animationDelay = `${0.2 + index * 0.05}s`;
                    card.classList.add('fade-in');
                    gridEl.appendChild(card);
                });
            }

            createReportCard(report) {
                const card = document.createElement('article');
                card.className = 'analysis-card';
                
                const isNew = (new Date() - new Date(report.date)) < 7 * 24 * 60 * 60 * 1000;
                
                card.innerHTML = `
                    <div class="analysis-meta">
                        <time class="analysis-date">${this.formatDate(report.date)}</time>
                        ${isNew ? '<span class="badge badge-new">NEW</span>' : ''}
                    </div>
                    <h3 class="analysis-heading">${report.title}</h3>
                    <p class="analysis-summary">${report.summary}</p>
                    <div class="analysis-tags">
                        ${report.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                    <a href="${report.link}" class="analysis-link">
                        ìì„¸íˆ ë³´ê¸° <span>â†’</span>
                    </a>
                `;

                card.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('analysis-link')) {
                        window.location.href = report.link;
                    }
                });

                return card;
            }

            formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('ko-KR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            const manager = new AnalysisReportManager();
            manager.init();
        });
    </script>
</body>
</html>