<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Coffee Market Weekly Report - ì»¤í”¼ ì„ ë¬¼ ì‹œì¥ ì£¼ê°„ ë™í–¥ ë³´ê³ ì„œ">
    <title>Weekly Report - Coffee Market Updates</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="styles/common.css" as="style">
    <link rel="stylesheet" href="styles/common.css">
    
    <style>
        /* Page-specific styles */
        .report-hero {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: white;
            padding: 48px 24px;
            border-radius: var(--radius-xl);
            margin-bottom: 40px;
            text-align: center;
            box-shadow: var(--shadow-xl);
        }

        .report-title {
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 700;
            margin-bottom: 12px;
        }

        .report-subtitle {
            font-size: 1.25rem;
            opacity: 0.9;
        }

        /* Info Section */
        .info-section {
            background: white;
            padding: 32px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            margin-bottom: 40px;
            border-top: 4px solid var(--primary-color);
        }

        .info-title {
            font-size: 1.75rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .info-content {
            color: var(--text-secondary);
            line-height: 1.8;
        }

        .info-list {
            margin: 20px 0 0 24px;
        }

        .info-list li {
            margin-bottom: 12px;
            position: relative;
        }

        .info-list li::before {
            content: 'â–¸';
            position: absolute;
            left: -20px;
            color: var(--primary-color);
            font-weight: bold;
        }

        /* Reports Grid */
        .reports-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        /* Enhanced Report Card */
        .report-item {
            background: white;
            border-radius: var(--radius-lg);
            padding: 28px;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            border-left: 4px solid var(--primary-color);
        }

        .report-item::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            width: 0;
            background: linear-gradient(90deg, transparent, rgba(139, 69, 19, 0.05));
            transition: width 0.3s ease;
        }

        .report-item:hover::after {
            width: 100%;
        }

        .report-item:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .report-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .report-date {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 0.875rem;
        }

        .report-heading {
            font-size: 1.375rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .report-summary {
            color: var(--text-secondary);
            font-size: 0.9375rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .report-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .report-link {
            color: var(--primary-color);
            font-weight: 600;
            text-decoration: none;
            font-size: 0.9375rem;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            transition: gap var(--transition-fast);
        }

        .report-link:hover {
            gap: 8px;
        }

        /* Loading & Empty States */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
        }

        .empty-state h3 {
            color: var(--text-secondary);
            font-size: 1.5rem;
            margin-bottom: 12px;
        }

        .empty-state p {
            color: var(--text-light);
        }

        /* Back Button */
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: white;
            padding: 12px 24px;
            border-radius: var(--radius-round);
            text-decoration: none;
            font-weight: 600;
            transition: all var(--transition-normal);
            margin-bottom: 32px;
            box-shadow: var(--shadow-md);
        }

        .back-link:hover {
            transform: translateX(-4px);
            box-shadow: var(--shadow-lg);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .report-hero {
                padding: 32px 20px;
            }
            
            .info-section {
                padding: 24px;
            }
            
            .reports-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">
            â† ë©”ì¸ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°
        </a>
        
        <div class="report-hero fade-in">
            <h1 class="report-title">ğŸ“‹ Weekly Report</h1>
            <p class="report-subtitle">ì»¤í”¼ ì„ ë¬¼ ì‹œì¥ ì£¼ê°„ ë™í–¥ ë³´ê³ ì„œ</p>
        </div>
        
        <div class="info-section fade-in" style="animation-delay: 0.1s;">
            <h2 class="info-title">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                </svg>
                Weekly Report ì†Œê°œ
            </h2>
            <div class="info-content">
                <p>ë§¤ì£¼ ë°œí–‰ë˜ëŠ” ì»¤í”¼ ì„ ë¬¼ ì‹œì¥ ì£¼ê°„ ë™í–¥ ë³´ê³ ì„œëŠ” ê¸€ë¡œë²Œ ì»¤í”¼ ì‹œì¥ì˜ ìµœì‹  ë™í–¥ê³¼ ê°€ê²© ë³€ë™ì„ ì‹¬ì¸µì ìœ¼ë¡œ ë¶„ì„í•©ë‹ˆë‹¤.</p>
                
                <ul class="info-list">
                    <li><strong>ë°œí–‰ ì£¼ê¸°:</strong> ì£¼ 1íšŒ ì—…ë°ì´íŠ¸ (ë§¤ì£¼ í† ìš”ì¼ ë°œê°„)</li>
                    <li><strong>ì£¼ìš” ë‚´ìš©:</strong> ì£¼ê°„ ê°€ê²© ë™í–¥, ìˆ˜ê¸‰ í˜„í™©, ê¸°í›„ ì˜í–¥, íˆ¬ê¸° í¬ì§€ì…˜ ë¶„ì„</li>
                    <li><strong>ë°ì´í„° ì†ŒìŠ¤:</strong> ICE, Reuters, Refinitiv, CFTC, ì£¼ìš” ìƒì‚°êµ­ í†µê³„ì²­</li>
                    <li><strong>ë¶„ì„ ë²”ìœ„:</strong> ì•„ë¼ë¹„ì¹´/ë¡œë¶€ìŠ¤íƒ€ ì„ ë¬¼, í˜„ë¬¼ ì‹œì¥, í™˜ìœ¨ ì˜í–¥</li>
                </ul>
            </div>
        </div>
        
        <div id="loadingState" class="loading-spinner fade-in" style="animation-delay: 0.2s;">
            <div class="spinner"></div>
            <p style="margin-top: 16px;">ë¦¬í¬íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
        
        <div class="reports-container" id="reportsGrid" style="display: none;">
            <!-- Reports will be dynamically loaded here -->
        </div>
        
        <div class="empty-state" id="emptyState" style="display: none;">
            <h3>ì£¼ê°„ ë™í–¥ ë¦¬í¬íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤</h3>
            <p>ì•„ì§ "ì»¤í”¼ ì„ ë¬¼ ì‹œì¥ ì£¼ê°„ ë™í–¥" ë¦¬í¬íŠ¸ê°€ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
        </div>
    </div>

    <script>
        // Optimized report loading system
        class WeeklyReportManager {
            constructor() {
                this.reports = [];
                this.loading = true;
            }

            async init() {
                await this.loadReports();
                this.render();
            }

            async loadReports() {
                try {
                    // Try loading from reports.json
                    const response = await fetch('reports.json');
                    if (response.ok) {
                        const data = await response.json();
                        this.reports = (data.reports || []).filter(report => 
                            this.isWeeklyReport(report)
                        );
                    }
                } catch (error) {
                    console.error('Failed to load reports:', error);
                    // Fallback to file scanning
                    this.reports = await this.scanWeeklyReports();
                }

                // Sort by date (newest first)
                this.reports.sort((a, b) => new Date(b.date) - new Date(a.date));
                this.loading = false;
            }

            isWeeklyReport(report) {
                if (report.type === 'weekly') return true;
                
                const title = report.title || '';
                return title.includes('ì£¼ê°„ ë™í–¥') || 
                       title.includes('ì»¤í”¼ ì‹œì¥ ì£¼ê°„ ë™í–¥') || 
                       title.includes('ì»¤í”¼ ì„ ë¬¼ ì‹œì¥ ì£¼ê°„ ë™í–¥');
            }

            async scanWeeklyReports() {
                // Simplified scanning for weekly reports
                const weeklyReports = [];
                const knownWeeklyFiles = [
                    'Reports/2025/09/2025-09-06.html',
                    'Reports/2025/08/2025-08-02.html',
                    'Reports/2025/07/2025-07-29.html',
                    'Reports/2025/07/2025-07-26.html',
                    'Reports/2025/07/2025-07-25.html',
                    'Reports/2025/07/2025-07-19.html',
                    'Reports/2025/07/2025-07-16.html',
                    'Reports/2025/07/2025-07-12.html',
                    'Reports/2025/07/2025-07-09.html',
                    'Reports/2025/07/2025-07-04.html',
                    'Reports/2025/06/2025-06-30.html',
                    'Reports/2025/06/2025-06-28.html',
                    'Reports/2025/06/2025-06-21.html',
                    'Reports/2025/05/2025-05-31.html'
                ];

                for (const file of knownWeeklyFiles) {
                    try {
                        const response = await fetch(file);
                        if (response.ok) {
                            const html = await response.text();
                            const metadata = this.extractMetadata(html, file);
                            if (metadata && this.isWeeklyReport(metadata)) {
                                weeklyReports.push({
                                    ...metadata,
                                    link: file
                                });
                            }
                        }
                    } catch (error) {
                        // Skip failed files
                    }
                }

                return weeklyReports;
            }

            extractMetadata(html, filePath) {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                const dateMatch = filePath.match(/(\d{4}-\d{2}-\d{2})/);
                const date = dateMatch ? dateMatch[1] : new Date().toISOString().split('T')[0];
                
                const title = doc.querySelector('h1')?.textContent?.trim() || 'ì»¤í”¼ ì„ ë¬¼ ì‹œì¥ ì£¼ê°„ ë™í–¥';
                const summary = doc.querySelector('.highlight p, .main-story p, p')?.textContent?.trim().substring(0, 200) || '';
                
                const tags = Array.from(doc.querySelectorAll('.tag'))
                    .map(tag => tag.textContent.trim())
                    .filter(Boolean)
                    .slice(0, 6);

                return {
                    title,
                    date,
                    summary: summary ? summary + '...' : 'ì£¼ê°„ ë™í–¥ ë³´ê³ ì„œì…ë‹ˆë‹¤.',
                    tags: tags.length ? tags : ['ì£¼ê°„ë™í–¥', 'ì»¤í”¼ì„ ë¬¼', 'ì‹œì¥ë¶„ì„']
                };
            }

            render() {
                const loadingEl = document.getElementById('loadingState');
                const gridEl = document.getElementById('reportsGrid');
                const emptyEl = document.getElementById('emptyState');

                if (this.loading) return;

                loadingEl.style.display = 'none';

                if (this.reports.length === 0) {
                    emptyEl.style.display = 'block';
                    return;
                }

                gridEl.style.display = 'grid';
                gridEl.innerHTML = '';

                this.reports.forEach((report, index) => {
                    const card = this.createReportCard(report);
                    card.style.animationDelay = `${0.2 + index * 0.05}s`;
                    card.classList.add('fade-in');
                    gridEl.appendChild(card);
                });
            }

            createReportCard(report) {
                const card = document.createElement('article');
                card.className = 'report-item';
                
                const isNew = (new Date() - new Date(report.date)) < 7 * 24 * 60 * 60 * 1000;
                
                card.innerHTML = `
                    <div class="report-meta">
                        <time class="report-date">${this.formatDate(report.date)}</time>
                        ${isNew ? '<span class="badge badge-new">NEW</span>' : ''}
                    </div>
                    <h3 class="report-heading">${report.title}</h3>
                    <p class="report-summary">${report.summary}</p>
                    <div class="report-tags">
                        ${report.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                    <a href="${report.link}" class="report-link">
                        ìì„¸íˆ ë³´ê¸° <span>â†’</span>
                    </a>
                `;

                card.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('report-link')) {
                        window.location.href = report.link;
                    }
                });

                return card;
            }

            formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('ko-KR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            const manager = new WeeklyReportManager();
            manager.init();
        });
    </script>
</body>
</html>